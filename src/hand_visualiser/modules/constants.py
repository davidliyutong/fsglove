import numpy as np
import torch
from scipy.spatial.transform import Rotation as R

# father - son relationship
mano_joint_fa = np.asarray([-1, 0, 1, 2, 0, 4, 5, 0, 7, 8, 0, 10, 11, 0, 13, 14], dtype=int)
mano_joint_fa_root = 0

# base rotation of mano coordinate system, deprecated, keep for reference
base_rotation = np.array([
    [-1, 0, 0],
    [0, 0, 1],
    [0, 1, 0]
])

# FIVE
mano_model_pose_0 = np.zeros(shape=(48,))

# THUMB_UP
mano_model_pose_1 = np.array([
    [0.0, 0.0, 0.0],
    [0.3311986029148102, -0.19967056810855865, 1.3603085279464722],
    [0.11507017910480499, 0.0, 1.6961010694503784],
    [-0.004635578021407127, 0.0, 0.899988055229187],
    [-0.05139815807342529, 0.0, 1.4490888118743896],
    [-0.3002052307128906, 0.0, 1.6732832193374634],
    [-0.15274466574192047, 0.0, 0.8869436383247375],
    [-0.7918587923049927, 0.19851918518543243, 1.2149279117584229],
    [-1.006446123123169, 0.0, 1.3700605630874634],
    [-0.49110475182533264, 0.0, 0.7541989684104919],
    [-0.429956316947937, -0.09989424049854279, 1.3323508501052856],
    [-0.30127280950546265, 0.0, 1.6730914115905762],
    [-0.2778366804122925, 0.0, 0.8560413718223572],
    [0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0]
])

# FOUR
mano_model_pose_2 = np.array([
    [0.0, 0.0, 0.0],
    [0.0, -0.30000001192092896, -0.05000000074505806],
    [0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0],
    [0.0, 0.6499999761581421, -0.20000000298023224],
    [0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0],
    [0.0, 0.2199999988079071, -0.05000000074505806],
    [0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0],
    [0.49035200476646423, -0.9200575947761536, -0.0956500694155693],
    [0.42956510186195374, -0.8161188364028931, 0.3865537941455841],
    [0.13731351494789124, -0.2528000473976135, 0.1154865100979805]
])

trivial_mano_pose = R.from_rotvec(np.zeros(shape=(16, 3)))
trivial_mano_tensor = torch.zeros(16, 3)
trivial_rotation_quats = np.array([0, 0, 0, 1])
trivial_position = np.zeros(shape=(3,))

shadow_join_names = [
    'wr2', 'wr1',
    'rh_THJ5', 'rh_THJ4', 'rh_THJ3', 'rh_THJ2', 'rh_THJ1',
    'rh_LFJ5', 'rh_LFJ4', 'rh_LFJ3', 'rh_LFJ2', 'rh_LFJ1',
    'rh_RFJ4', 'rh_RFJ3', 'rh_RFJ2', 'rh_RFJ1',
    'rh_MFJ4', 'rh_MFJ3', 'rh_MFJ2', 'rh_MFJ1',
    'rh_FFJ4', 'rh_FFJ3', 'rh_FFJ2', 'rh_FFJ1',
]
